{% extends 'basic_page.html' %}

{% block basic_page_headers %}
    <link rel="stylesheet" media="all" href="{{ static('stylesheets/dashboard.css') }}">
{% endblock %}

{% block basic_page_title %}Hacker Dashboard{% endblock %}
{% block pagetitle %}MHacks Dashboard{% endblock %}

{% block basic_page_content %}
    <br>

    <div class="body-info" id="main-message">
        {% if request.user and request.user.groups.filter(name='application_reader').exists() %}
            <h2>Looks like you're an application reader!</h2>
            <a href="{{url_for('mhacks-applicationSearch')}}"><button type="button">Read Apps</button></a>
        {% endif %}

        {% if request.user and request.user.groups.filter(name='sponsor').exists() %}
            <h2>Looks like you're a sponsor!</h2>
            <a href="{{url_for('mhacks-sponsorPortal')}}"><button type="button">Sponsor Portal</button></a>
        {% endif %}

        {% if request.user and request.user.groups.filter(name='stats_team').exists() %}
            <h2>Looks like you're on the stats team!</h2>
            <a href="{{url_for('mhacks-stats')}}"><button type="button">Stats</button></a>
        {% endif %}

        <br>

        {% if request.user and request.user.groups.filter(name='hacker').exists() %}
            {% if registration_application and registration_application.submitted %}
                {% if registration_application.acceptance == 'accepted_yes' %}
                    <h2>Registration Status: <span class="rounded-box accept">ACCEPTED INVITE</span></h2>
                    <p>You should have received an email with your pass to the event.</p>
                    <p>If you can't find it, you can present this QR code too.</p>
                    <img class="qr-code" src="data:image/png;base64,{{ qr_code }}">
                    <a href="{{ url_for('mhacks-apple-pass') }}">
                        <img class="apple-wallet" src="{{ static('assets/add_apple_wallet.svg') }}">
                    </a>
                {% elif registration_application.acceptance == 'accepted_no' %}
                    <h2>Registration Status: <span class="rounded-box decline">DECLINED INVITE</span></h2>
                {% endif %}
            {% endif %}

            {% if application %}
                {% if application.decision == 'Accept' %}
                    <h2>Application Status: <span class="rounded-box accept">ACCEPTED</span></h2>
                    <p>You‚Äôre awesome. We‚Äôre awesome. Head over to our <a href="https://www.facebook.com/events/257902701319629/">Facebook event page</a> and join the community!</p>
                    <p>For those of you driving to MHacks 9, head to our sign-up sheet <a href="http://www.groupcarpool.com/t/q8kbid">here</a> if you would like to set up a carpool.</p>
                    <p style="margin: 20px auto 0;">There will be two MHacks buses üöå: </p>
                    <p style="margin: 0 auto; padding-left: 25px">‚Ä¢ University of Toronto -> University of Waterloo -> University of Michigan </p>
                    <p style="margin: 0 auto; padding-left: 25px">‚Ä¢ University of Illinois at Urbana-Champaign -> Purdue University -> University of Michigan </p>
                    <p style="margin: 0 auto 20px;">Space is limited, so sign up ASAP to guarantee a spot on the bus. Check back soon for bus itineraries and a bus registration link. </p>

                    {% if not registration_application %}
                        <p>Hit the button below to confirm your acceptance!</p>
                        <a href="{{ url_for('mhacks-registration') }}"><button type="button">Confirm Acceptance</button></a>
                    {% endif %}
                    {% if application.reimbursement %}
                        <br />
                        <br />
                        <h2>Reimbursement amount: <span class="rounded-box accept">${{ '{:.2f}'.format(application.reimbursement) }}</span> </h2>
                        <p>If you are flying ‚úàÔ∏èÔ∏è to MHacks, you currently have 5 days to send your flight receipt to <a href="mailto:flymhacks@umich.edu">flymhacks@umich.edu</a>! A bus will arrive at Detroit Metro Airport to shuttle hackers to Ann Arbor at 5:00pm ET. Please ensure that you will land in time to catch this bus.</p>
                        <p>If you are driving üöó to MHacks, please save all gas/parking receipts; you will have until 11:59pm ET on Friday, March 31st to email all receipts you would like to be reimbursed for in a single email to <a href="mailto:flymhacks@umich.edu">flymhacks@umich.edu</a>.</p>
                        <p>For more information check <a href="https://drive.google.com/file/d/0B4fSxuPetYFGTEFLTTJWbUd4cU0/view?usp=sharing">this document</a></p>
                        <p>Please note you must submit a hack at MHacks 9 to receive your travel reimbursement</p>
                        <p>We‚Äôll see you there!</p>
                    {% endif %}
                {% elif application.decision == 'Waitlist' %}
                    <h2>Application Status: <span class="rounded-box waitlist">WAITLIST</span></h2>
                    <p>Thank you for applying to MHacks 9. Unfortunately, we can't extend you an invitation at the moment, but hang tight! If there‚Äôs a change in your decision, we‚Äôll let you know.</p>
                {% elif application.decision == 'Decline' %}
                    <div>
                        <h2>Your application has been submitted. We look forward to reading it!</h2>
                    </div>
                    <div class="rounded-box decline">
                        <p>We haven‚Äôt gotten to read your application just yet, but we‚Äôre on it! You should receive a decision by next Monday. Hang tight!</p>
                    </div>
                    <div>
                        <p>If you need to edit your application, use the buttons below.</p>
                    </div>
                    <div class="row-container">
                        <form method="GET" action="{{ url_for('mhacks-apply') }}">
                            <button type="submit">Hacker</button>
                        </form>
                        <form method="GET" action="{{ url_for('mhacks-applyMentor') }}">
                            <button type="submit">Mentor</button>
                        </form>
                    </div>
                {% endif %}
{#            {% else %}#}
{#                <h2>Welcome to your hacker dashboard! Check back here for MHacks 9 invitations, travel reimbursements, and registration forms.</h2>#}
            {% endif %}
        {% endif %}
        {% if not registration_application and not application %}
        <div class="dashboard-registration">
            <h2>Hi! Welcome to your Dashboard!</h2>
            <p>This is where you'll find updates on your application status, travel reimbursements, and registration
                forms. Fill out one of the applications below if you want to attend MHacks 9.</p>
            <p> For those who want to both hack and mentor, use the Hacker application. </p>
            <p> If you think you might need a Travel Reimbursement, you must
                apply by <strong>Saturday, February 18th</strong>. Otherwise, the application is open until
                <strong>Friday, March 10th</strong>.</p>
            <div class="row-container">
                <form method="GET" action="{{ url_for('mhacks-apply') }}">
                    <button type="submit">Hacker</button>
                </form>
                <form method="GET" action="{{ url_for('mhacks-applyMentor') }}">
                    <button type="submit">Mentor</button>
                </form>
            </div>
        </div>
        {% endif %}
    </div>
    {# Enable registration for walk-ons #}

    {# Disable applications for now #}
    {#    {% if not application %}#}
    {#        <div class="body-info" id="apply-instructions">#}
    {#            <h2>Here‚Äôs how it works:</h2>#}
    {#            <p>When you‚Äôre ready, hit the apply button and fill out an application. Our decisions are released on a weekly basis, so if you submit an application by Friday at 11:59pm, you will receive a decision on Monday.</p>#}
    {#            <p>If you submit an application after Friday at 11:59pm, your application will be read in the next cycle.</p>#}
    {#            <p>If you need to change your answers, don‚Äôt worry! Just make sure you submit your changes before Friday 11:59pm of that week.</p>#}
    {#            <p>Make sure you submit an application by September 9th in order to be considered for a travel reimbursement!</p>#}
    {#            <a href="{{ url_for('mhacks-apply') }}"><b>Let‚Äôs do this.</b></a>#}
    {#        </div>#}
    {#    {% endif %}#}
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>
        $(document).ready(function() {
            $("#bus-routes").hide();
            $("#bus-routes-link").on("click", function() {
                if ($("#bus-routes").is(":visible")) {
                    $("#bus-routes").hide();
                } else {
                    $("#bus-routes").show();
                }
            });
        });
    </script>
{% endblock %}

